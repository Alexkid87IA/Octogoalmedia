import{j as l}from"./sanity-tkM5Czdy.js";import{p as c,s as i}from"./index-25U1HBy9.js";const y=({size:e="medium",color:t="blue",text:r})=>{const s={small:"w-5 h-5",medium:"w-8 h-8",large:"w-12 h-12"},o={blue:"text-accent-blue",white:"text-white",gray:"text-gray-300"};return l.jsxs("div",{className:"flex flex-col items-center justify-center",role:"status","aria-live":"polite",children:[l.jsxs("svg",{className:`animate-spin ${s[e]} ${o[t]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r&&l.jsx("span",{className:`mt-2 ${o[t]}`,children:r}),l.jsx("span",{className:"sr-only",children:"Chargement en cours"})]})},u={},d=5*60*1e3;async function n(e,t){const r=Date.now(),s=u[e];if(s&&r-s.timestamp<d)return console.log(`Utilisation du cache pour ${e}`),s.data;try{const o=await t();return u[e]={data:o,timestamp:r},o}catch(o){throw console.error(`Erreur lors de la r√©cup√©ration des donn√©es pour ${e}:`,o),o}}const h=async()=>n("allArticles",async()=>{try{const t=await i.fetch(`*[_type == "article"] | order(publishedAt desc) {
        _id,
        title,
        slug,
        contentType,
        mainImage {
          asset->{
            _ref,
            _type,
            url
          },
          hotspot,
          crop
        },
        excerpt,
        publishedAt,
        keyPoints,
        readingTime,
        duration,
        videoUrl,
        guest,
        isEssential,
        isTrending,
        isFeatured,
        stats,
        categories[]->{
          _id,
          title,
          slug
        },
        subcategories[]->{
          _id,
          title,
          slug,
          parentCategory->{
            _id,
            title,
            slug
          }
        },
        author->{
          _id,
          name,
          "imageUrl": image.asset->url,
          image {
            asset->{
              _ref,
              _type,
              url
            },
            hotspot,
            crop
          },
          bio
        }
      }`);if(console.log(`Articles r√©cup√©r√©s: ${(t==null?void 0:t.length)||0}`),t&&t.length>0){const r=[...new Set(t.map(s=>s.contentType))];console.log("Types de contenu disponibles:",r),console.log("Premier article mainImage:",t[0].mainImage)}return t||[]}catch(e){return console.error("Erreur lors de la r√©cup√©ration des articles:",e),[]}}),m=async(e,t=!1)=>{if(console.log("üîç getArticleBySlug appel√© avec:",{slug:e,preview:t}),t)try{console.log("üîç Utilisation du previewClient"),console.log("üìä Configuration du previewClient:",{dataset:c.config().dataset,perspective:c.config().perspective,hasToken:!!c.config().token});const r=`*[_type == "article" && slug.current == $slug][0] {
        _id,
        _rev,
        _type,
        title,
        slug,
        contentType,
        mainImage {
          asset->{
            _ref,
            _type,
            url
          },
          hotspot,
          crop
        },
        body,
        excerpt,
        publishedAt,
        keyPoints,
        readingTime,
        duration,
        videoUrl,
        guest,
        isEssential,
        isTrending,
        isFeatured,
        stats,
        categories[]->{
          _id,
          title,
          slug
        },
        subcategories[]->{
          _id,
          title,
          slug,
          parentCategory->{
            _id,
            title,
            slug
          }
        },
        author->{
          _id,
          name,
          "imageUrl": image.asset->url,
          image {
            asset->{
              _ref,
              _type,
              url
            },
            hotspot,
            crop
          },
          bio
        }
      }`;console.log("üîç Ex√©cution de la requ√™te preview pour slug:",e),console.log("üîé Requ√™te GROQ:",r);const s=await c.fetch(r,{slug:e});if(console.log("‚úÖ R√©sultat de la requ√™te preview:",{found:!!s,id:s==null?void 0:s._id,title:s==null?void 0:s.title,contentType:s==null?void 0:s.contentType,keyPoints:s==null?void 0:s.keyPoints,isPublished:(s==null?void 0:s._id)&&!s._id.startsWith("drafts.")}),!s){console.log("‚ö†Ô∏è Aucun article trouv√©, recherche des brouillons...");const o=`*[_type == "article" && (_id match "drafts.*") && slug.current == $slug][0] {
          _id,
          _rev,
          _type,
          title,
          slug,
          contentType,
          mainImage {
            asset->{
              _ref,
              _type,
              url
            },
            hotspot,
            crop
          },
          body,
          excerpt,
          publishedAt,
          keyPoints,
          readingTime,
          duration,
          videoUrl,
          guest,
          isEssential,
          isTrending,
          isFeatured,
          stats,
          categories[]->{
            _id,
            title,
            slug
          },
          subcategories[]->{
            _id,
            title,
            slug,
            parentCategory->{
              _id,
              title,
              slug
            }
          },
          author->{
            _id,
            name,
            "imageUrl": image.asset->url,
            image {
              asset->{
                _ref,
                _type,
                url
              },
              hotspot,
              crop
            },
            bio
          }
        }`;console.log("üîé Requ√™te sp√©cifique brouillons:",o);const a=await c.fetch(o,{slug:e});return console.log("üìã R√©sultat recherche brouillons:",{found:!!a,id:a==null?void 0:a._id,contentType:a==null?void 0:a.contentType,keyPoints:a==null?void 0:a.keyPoints}),a}return s}catch(r){return console.error(`‚ùå Erreur lors de la r√©cup√©ration preview de l'article ${e}:`,r),console.error("D√©tails de l'erreur:",r),null}return console.log("üìö Utilisation du mode normal (avec cache)"),n(`article_${e}`,async()=>{var r;try{const o=await i.fetch(`*[_type == "article" && slug.current == $slug][0] {
        _id,
        title,
        slug,
        contentType,
        mainImage {
          asset->{
            _ref,
            _type,
            url
          },
          hotspot,
          crop
        },
        body,
        excerpt,
        publishedAt,
        keyPoints,
        readingTime,
        duration,
        videoUrl,
        guest,
        isEssential,
        isTrending,
        isFeatured,
        stats,
        categories[]->{
          _id,
          title,
          slug
        },
        subcategories[]->{
          _id,
          title,
          slug,
          parentCategory->{
            _id,
            title,
            slug
          }
        },
        author->{
          _id,
          name,
          "imageUrl": image.asset->url,
          image {
            asset->{
              _ref,
              _type,
              url
            },
            hotspot,
            crop
          },
          bio
        }
      }`,{slug:e});return console.log("üìã Article r√©cup√©r√© avec contentType:",o==null?void 0:o.contentType),console.log("üéØ Hotspot data:",(r=o==null?void 0:o.mainImage)==null?void 0:r.hotspot),o}catch(s){return console.error(`Erreur lors de la r√©cup√©ration de l'article ${e}:`,s),null}})},_=async e=>n(`articles_category_${e}`,async()=>{try{const r=await i.fetch('*[_type == "category" && slug.current == $categorySlug][0]._id',{categorySlug:e});if(!r)return console.log(`Cat√©gorie non trouv√©e pour le slug: ${e}`),[];const o=await i.fetch(`*[_type == "article" && references($categoryId)] | order(publishedAt desc) {
        _id,
        title,
        slug,
        contentType,
        mainImage {
          asset->{
            _ref,
            _type,
            url
          },
          hotspot,
          crop
        },
        excerpt,
        publishedAt,
        keyPoints,
        readingTime,
        duration,
        videoUrl,
        guest,
        isEssential,
        isTrending,
        isFeatured,
        stats,
        categories[]->{
          _id,
          title,
          slug
        },
        subcategories[]->{
          _id,
          title,
          slug,
          parentCategory->{
            _id,
            title,
            slug
          }
        }
      }`,{categoryId:r});return console.log(`Articles trouv√©s pour ${e}: ${o.length}`),o}catch(t){return console.error(`Erreur lors de la r√©cup√©ration des articles de la cat√©gorie ${e}:`,t),[]}}),b=async e=>n(`category_${e}`,async()=>{try{return await i.fetch(`*[_type == "category" && slug.current == $slug][0] {
        _id,
        title,
        slug,
        description
      }`,{slug:e})}catch(t){return console.error(`Erreur lors de la r√©cup√©ration de la cat√©gorie ${e}:`,t),null}}),f=async()=>n("featuredVSPoll",async()=>{try{return await i.fetch(`*[_type == "vsPoll" && featured == true && active == true] | order(publishedAt desc)[0] {
        _id,
        title,
        question,
        slug,
        option1 {
          name,
          subtitle,
          image {
            asset->{
              _ref,
              _type,
              url
            },
            hotspot,
            crop
          },
          color,
          votes
        },
        option2 {
          name,
          subtitle,
          image {
            asset->{
              _ref,
              _type,
              url
            },
            hotspot,
            crop
          },
          color,
          votes
        },
        context,
        featured,
        active,
        publishedAt,
        endsAt
      }`)}catch(e){return console.error("Erreur lors de la r√©cup√©ration du VS Poll √† la une:",e),null}}),$=async e=>n(`articles_subcategory_${e}`,async()=>{try{const r=await i.fetch('*[_type == "subcategory" && slug.current == $subcategorySlug][0]._id',{subcategorySlug:e});if(!r)return console.log(`Sous-cat√©gorie non trouv√©e pour le slug: ${e}`),[];const o=await i.fetch(`*[_type == "article" && references($subcategoryId)] | order(publishedAt desc) {
        _id,
        title,
        slug,
        contentType,
        mainImage {
          asset->{
            _ref,
            _type,
            url
          },
          hotspot,
          crop
        },
        excerpt,
        publishedAt,
        keyPoints,
        readingTime,
        duration,
        videoUrl,
        guest,
        isTrending,
        isFeatured,
        isEssential,
        stats,
        categories[]->{
          _id,
          title,
          slug
        },
        subcategories[]->{
          _id,
          title,
          slug,
          parentCategory->{
            _id,
            title,
            slug
          }
        }
      }`,{subcategoryId:r});return console.log(`Articles trouv√©s pour ${e}: ${o.length}`),o}catch(t){return console.error(`Erreur lors de la r√©cup√©ration des articles de la sous-cat√©gorie ${e}:`,t),[]}}),w=async e=>n(`subcategory_${e}`,async()=>{try{return await i.fetch(`*[_type == "subcategory" && slug.current == $slug][0] {
        _id,
        title,
        slug,
        description,
        parentCategory->{
          _id,
          title,
          slug
        }
      }`,{slug:e})}catch(t){return console.error(`Erreur lors de la r√©cup√©ration de la sous-cat√©gorie ${e}:`,t),null}}),A=async(e=50)=>n(`octogoalEmissions_${e}`,async()=>{try{const r=await i.fetch(`*[_type == "emission"] | order(publishedAt desc)[0...$limit] {
        _id,
        title,
        "slug": slug.current,
        episodeNumber,
        youtubeUrl,
        "thumbnail": thumbnail.asset->url,
        duration,
        description,
        publishedAt,
        themes
      }`,{limit:e});return console.log(`√âmissions Octogoal r√©cup√©r√©es: ${(r==null?void 0:r.length)||0}`),r||[]}catch(t){return console.error("Erreur lors de la r√©cup√©ration des √©missions Octogoal:",t),[]}}),v=async()=>n("latestOctogoalEmission",async()=>{try{const t=await i.fetch(`*[_type == "emission"] | order(publishedAt desc)[0] {
        _id,
        title,
        "slug": slug.current,
        episodeNumber,
        youtubeUrl,
        "thumbnail": thumbnail.asset->url,
        duration,
        description,
        publishedAt,
        themes
      }`);return console.log("Derni√®re √©mission Octogoal:",(t==null?void 0:t.title)||"Aucune"),t}catch(e){return console.error("Erreur lors de la r√©cup√©ration de la derni√®re √©mission:",e),null}}),x=async(e=20)=>n(`octogoalExtraits_${e}`,async()=>{try{const r=await i.fetch(`*[_type == "extrait"] | order(publishedAt desc)[0...$limit] {
        _id,
        title,
        youtubeShortUrl,
        "thumbnail": thumbnail.asset->url,
        duration,
        publishedAt,
        emission->{
          _id,
          title,
          episodeNumber
        }
      }`,{limit:e});return console.log(`Extraits Octogoal r√©cup√©r√©s: ${(r==null?void 0:r.length)||0}`),r||[]}catch(t){return console.error("Erreur lors de la r√©cup√©ration des extraits:",t),[]}});export{y as L,f as a,_ as b,b as c,w as d,$ as e,v as f,h as g,A as h,x as i,m as j};
